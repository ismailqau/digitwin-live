# =============================================================================
# TEST ENVIRONMENT
# =============================================================================
# This file contains test-specific settings
# Used for running automated tests
# =============================================================================

NODE_ENV=test

# -----------------------------------------------------------------------------
# TEST SERVICES
# -----------------------------------------------------------------------------
API_GATEWAY_PORT=3002
API_GATEWAY_HOST=localhost

WEBSOCKET_PORT=3003
WEBSOCKET_HOST=localhost

# -----------------------------------------------------------------------------
# CORS
# -----------------------------------------------------------------------------
CORS_ORIGIN=*

# -----------------------------------------------------------------------------
# JWT - Test secrets
# -----------------------------------------------------------------------------
JWT_SECRET=test-jwt-secret
REFRESH_SECRET=test-refresh-secret
ACCESS_TOKEN_EXPIRY=15m
REFRESH_TOKEN_EXPIRY=7d

# -----------------------------------------------------------------------------
# DATABASE - Test database
# -----------------------------------------------------------------------------
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=digitwinline_test
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres
DATABASE_SSL=false
DATABASE_POOL_MIN=1
DATABASE_POOL_MAX=5

DATABASE_URL=postgresql://postgres:postgres@localhost:5432/digitwinline_test

# -----------------------------------------------------------------------------
# CACHING - PostgreSQL-based (no separate cache service needed)
# -----------------------------------------------------------------------------
ENABLE_CACHING=false
# Disabled for faster test execution

# -----------------------------------------------------------------------------
# OAUTH - Mock credentials for testing
# -----------------------------------------------------------------------------
GOOGLE_CLIENT_ID=test-google-client-id
GOOGLE_CLIENT_SECRET=test-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:3002/api/v1/auth/oauth/google/callback

APPLE_CLIENT_ID=com.test.digitwinlive
APPLE_TEAM_ID=TEST_TEAM
APPLE_KEY_ID=TEST_KEY
APPLE_PRIVATE_KEY_PATH=./test/fixtures/apple-private-key-test.p8
APPLE_REDIRECT_URI=http://localhost:3002/api/v1/auth/oauth/apple/callback

# -----------------------------------------------------------------------------
# AI SERVICES - Mock all external services
# -----------------------------------------------------------------------------
MOCK_EXTERNAL_SERVICES=true

# Mock API keys (not used when mocking is enabled)
GOOGLE_CHIRP_API_KEY=test-chirp-key
GEMINI_API_KEY=test-gemini-key
OPENAI_API_KEY=test-openai-key
GROQ_API_KEY=test-groq-key

# -----------------------------------------------------------------------------
# VECTOR DATABASE - PostgreSQL with pgvector (uses same DATABASE_URL)
# -----------------------------------------------------------------------------
# Vector search is handled by PostgreSQL with pgvector extension
# No additional configuration needed - uses DATABASE_URL above
VECTOR_DIMENSIONS=768  # Google text-embedding-004 dimension
VECTOR_INDEX_LISTS=100  # IVFFlat index parameter

# -----------------------------------------------------------------------------
# GCP - Test project
# -----------------------------------------------------------------------------
GCP_PROJECT_ID=digitwinlive-test
GCP_REGION=us-central1
GOOGLE_APPLICATION_CREDENTIALS=./test/fixtures/gcp-service-account-test.json

GCS_BUCKET_VOICE_MODELS=clone-voice-models-test
GCS_BUCKET_FACE_MODELS=clone-face-models-test
GCS_BUCKET_DOCUMENTS=clone-documents-test
GCS_BUCKET_UPLOADS=clone-uploads-test

# -----------------------------------------------------------------------------
# GPU SERVICES - Mock endpoints
# -----------------------------------------------------------------------------
XTTS_SERVICE_URL=http://localhost:8002
XTTS_GPU_ENABLED=false

LIPSYNC_SERVICE_URL=http://localhost:8003
LIPSYNC_MODEL=tpsm
LIPSYNC_GPU_ENABLED=false

# -----------------------------------------------------------------------------
# RATE LIMITING - Disabled for tests
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=10000
RATE_LIMIT_AUTH_MAX=1000
RATE_LIMIT_UPLOAD_MAX=1000

# -----------------------------------------------------------------------------
# LOGGING - Minimal logging for tests
# -----------------------------------------------------------------------------
LOG_LEVEL=error
LOG_FORMAT=simple
LOG_FILE_PATH=./logs/test.log
LOG_ERROR_FILE_PATH=./logs/test-error.log

# -----------------------------------------------------------------------------
# MONITORING - Disabled for tests
# -----------------------------------------------------------------------------
SENTRY_DSN=
SENTRY_ENVIRONMENT=test

# -----------------------------------------------------------------------------
# EMAIL - Mock email service
# -----------------------------------------------------------------------------
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=test@digitwinlive.test
SMTP_FROM_NAME=Test

# -----------------------------------------------------------------------------
# PAYMENT - Mock Stripe
# -----------------------------------------------------------------------------
STRIPE_SECRET_KEY=sk_test_mock
STRIPE_PUBLISHABLE_KEY=pk_test_mock
STRIPE_WEBHOOK_SECRET=whsec_test_mock

# -----------------------------------------------------------------------------
# FEATURE FLAGS - All enabled for testing
# -----------------------------------------------------------------------------
FEATURE_OAUTH_GOOGLE=true
FEATURE_OAUTH_APPLE=true
FEATURE_VOICE_CLONING=true
FEATURE_FACE_CLONING=true
FEATURE_VIDEO_GENERATION=true
FEATURE_ANALYTICS=true

# -----------------------------------------------------------------------------
# TEST TOOLS
# -----------------------------------------------------------------------------
ENABLE_API_DOCS=false
ENABLE_DEBUG_ENDPOINTS=true
ENABLE_CACHING=false
ENABLE_COMPRESSION=false

# -----------------------------------------------------------------------------
# SUBSCRIPTION LIMITS - Unlimited for tests
# -----------------------------------------------------------------------------
FREE_TIER_CONVERSATION_MINUTES_PER_DAY=10000
FREE_TIER_DOCUMENTS_PER_MONTH=10000
FREE_TIER_VOICE_MODELS=100

PRO_TIER_CONVERSATION_MINUTES_PER_DAY=0
PRO_TIER_DOCUMENTS_PER_MONTH=0
PRO_TIER_VOICE_MODELS=0

# -----------------------------------------------------------------------------
# SECURITY - Relaxed for tests
# -----------------------------------------------------------------------------
PASSWORD_MIN_LENGTH=4
PASSWORD_REQUIRE_UPPERCASE=false
PASSWORD_REQUIRE_LOWERCASE=false
PASSWORD_REQUIRE_NUMBERS=false
PASSWORD_REQUIRE_SPECIAL_CHARS=false

SESSION_SECRET=test-session-secret
SESSION_TIMEOUT_MINUTES=60

CSRF_SECRET=test-csrf-secret

# -----------------------------------------------------------------------------
# TEST DATA
# -----------------------------------------------------------------------------
TEST_USER_EMAIL=test@example.com
TEST_USER_PASSWORD=testpassword123
TEST_ADMIN_EMAIL=admin@example.com
TEST_ADMIN_PASSWORD=adminpassword123
