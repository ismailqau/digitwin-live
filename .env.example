# =============================================================================
# CONVERSATIONAL CLONE - ENVIRONMENT VARIABLES
# =============================================================================
# Copy this file to .env and fill in your actual values
# Never commit .env files to version control
# =============================================================================

# -----------------------------------------------------------------------------
# APPLICATION ENVIRONMENT
# -----------------------------------------------------------------------------
NODE_ENV=development
# Options: development, staging, production

# -----------------------------------------------------------------------------
# SERVICE URLS - LOCAL DEVELOPMENT
# -----------------------------------------------------------------------------
# Use these when running services locally
API_GATEWAY_URL=http://127.0.0.1:3000
WEBSOCKET_URL=ws://127.0.0.1:3001
FACE_PROCESSING_URL=http://127.0.0.1:8001

# -----------------------------------------------------------------------------
# SERVICE URLS - GOOGLE CLOUD RUN (Production)
# -----------------------------------------------------------------------------
# Use these when services are deployed to GCP Cloud Run
# API_GATEWAY_URL=https://api-gateway-yrzc7r3fcq-uc.a.run.app
# WEBSOCKET_URL=wss://websocket-server-yrzc7r3fcq-uc.a.run.app
# FACE_PROCESSING_URL=https://face-processing-service-yrzc7r3fcq-uc.a.run.app

# -----------------------------------------------------------------------------
# API GATEWAY CONFIGURATION
# -----------------------------------------------------------------------------
API_GATEWAY_PORT=3000
API_GATEWAY_HOST=127.0.0.1
# Local: 127.0.0.1
# GCP Cloud Run: 0.0.0.0 (Cloud Run sets PORT automatically)

# CORS Configuration
CORS_ORIGIN=*
# Local: *
# Production: https://app.digitwinlive.com,https://admin.digitwinlive.com

# -----------------------------------------------------------------------------
# WEBSOCKET SERVER CONFIGURATION
# -----------------------------------------------------------------------------
WEBSOCKET_PORT=3001
WEBSOCKET_HOST=127.0.0.1
# Local: 127.0.0.1
# GCP Cloud Run: 0.0.0.0 (Cloud Run sets PORT automatically to 8080)

# -----------------------------------------------------------------------------
# FACE PROCESSING SERVICE CONFIGURATION
# -----------------------------------------------------------------------------
FACE_PROCESSING_PORT=8001
FACE_PROCESSING_HOST=127.0.0.1
# Local: 127.0.0.1
# GCP Cloud Run: 0.0.0.0 (Cloud Run sets PORT automatically to 8080)

# -----------------------------------------------------------------------------
# JWT AUTHENTICATION
# -----------------------------------------------------------------------------
# Generate secure secrets using: openssl rand -base64 32
# IMPORTANT: Use different secrets for development and production!

JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
# Local Development: Any random string (generate with openssl rand -base64 32)
# GCP Production: Use ${SECRET_JWT_SECRET} placeholder
#   Store actual secret in GCP Secret Manager as 'jwt-secret'

REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production
# Local Development: Any random string (generate with openssl rand -base64 32)
# GCP Production: Use ${SECRET_REFRESH_SECRET} placeholder
#   Store actual secret in GCP Secret Manager as 'refresh-secret'

# Token Expiry (examples: 15m, 1h, 7d)
ACCESS_TOKEN_EXPIRY=15m
# Short-lived access tokens for security
REFRESH_TOKEN_EXPIRY=7d
# Longer-lived refresh tokens for convenience

# -----------------------------------------------------------------------------
# OAUTH2 CONFIGURATION - GOOGLE
# -----------------------------------------------------------------------------
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://127.0.0.1:3000/api/v1/auth/oauth/google/callback
# GCP: https://api-gateway-yrzc7r3fcq-uc.a.run.app/api/v1/auth/oauth/google/callback

# -----------------------------------------------------------------------------
# OAUTH2 CONFIGURATION - APPLE
# -----------------------------------------------------------------------------
# Get credentials from: https://developer.apple.com/account/resources/identifiers/list
APPLE_CLIENT_ID=com.yourcompany.digitwinlive
APPLE_TEAM_ID=YOUR_TEAM_ID
APPLE_KEY_ID=YOUR_KEY_ID
APPLE_PRIVATE_KEY_PATH=./secrets/apple-private-key.p8
APPLE_REDIRECT_URI=http://127.0.0.1:3000/api/v1/auth/oauth/apple/callback
# GCP: https://api-gateway-yrzc7r3fcq-uc.a.run.app/api/v1/auth/oauth/apple/callback

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION - POSTGRESQL with pgvector
# -----------------------------------------------------------------------------
# PostgreSQL 15+ with pgvector extension for vector storage
# No separate vector database needed - all data in one place!

DATABASE_HOST=127.0.0.1
# Local Development: 127.0.0.1
# Local with Cloud SQL Proxy: 127.0.0.1 (proxy listens on port 5433)
# GCP Cloud Run: /cloudsql/PROJECT:REGION:INSTANCE (Unix socket path)
#   Example: /cloudsql/digitwinlive:us-central1:digitwinlive-db

DATABASE_PORT=5432
# Local Development: 5432 (standard PostgreSQL port)
# Local with Cloud SQL Proxy: 5433 (proxy port to avoid conflicts)
# GCP Cloud Run: 5432 (Unix socket doesn't actually use port)

DATABASE_NAME=digitwinlive-db
# Database name (same for all environments)

DATABASE_USER=postgres
# Database user (typically 'postgres' for Cloud SQL)

DATABASE_PASSWORD=your-database-password
# Local Development: Any password for your local PostgreSQL
# GCP Production: Use ${SECRET_DATABASE_PASSWORD} placeholder
#   The actual secret is stored in GCP Secret Manager and mounted at runtime

DATABASE_SSL=false
# Local Development: false (not needed for localhost)
# GCP Cloud Run: false (Unix socket connection doesn't need SSL)
# Note: Cloud SQL is secure by default with Unix socket

# Connection Pool Settings
DATABASE_POOL_MIN=2
# Minimum connections: 2 (dev), 5 (prod)
DATABASE_POOL_MAX=10
# Maximum connections: 10 (dev), 50 (prod)

# Cloud SQL Connection Name (for GCP Cloud Run)
CLOUD_SQL_CONNECTION_NAME=digitwinlive:us-central1:digitwinlive-db
# Format: PROJECT_ID:REGION:INSTANCE_NAME
# Used by Cloud Run's --add-cloudsql-instances flag

# Database URL (Prisma connection string)
# Choose ONE of the following based on your environment:

# Option 1: Local Development (standard PostgreSQL)
DATABASE_URL=postgresql://postgres:your-database-password@127.0.0.1:5432/digitwinlive-db

# Option 2: Local Development with Cloud SQL Proxy (recommended for testing)
# DATABASE_URL=postgresql://postgres:your-database-password@127.0.0.1:5433/digitwinlive-db

# Option 3: GCP Cloud Run with Cloud SQL Unix Socket (production)
# DATABASE_URL=postgresql://postgres:${SECRET_DATABASE_PASSWORD}@/digitwinlive-db?host=/cloudsql/digitwinlive:us-central1:digitwinlive-db


# -----------------------------------------------------------------------------
# CACHING CONFIGURATION (PostgreSQL-based)
# -----------------------------------------------------------------------------
# Caching is implemented using PostgreSQL indexed cache tables
# No separate cache service required - uses main database

# Cache TTL (Time To Live) in seconds
CACHE_TTL_SHORT=300
# 5 minutes
CACHE_TTL_MEDIUM=3600
# 1 hour
CACHE_TTL_LONG=86400
# 24 hours

# Enable/disable caching
ENABLE_CACHING=true

# -----------------------------------------------------------------------------
# VECTOR DATABASE - PostgreSQL with pgvector (uses same DATABASE_URL)
# -----------------------------------------------------------------------------
# Vector search is handled by PostgreSQL with pgvector extension
# No additional configuration needed - uses DATABASE_URL above
VECTOR_DIMENSIONS=768  # Google text-embedding-004 dimension
VECTOR_INDEX_LISTS=100  # IVFFlat index parameter

# -----------------------------------------------------------------------------
# GOOGLE CLOUD PLATFORM
# -----------------------------------------------------------------------------
GCP_PROJECT_ID=digitwinlive
# Your GCP project ID (create at console.cloud.google.com)

GCP_REGION=us-central1
# GCP region for all resources (us-central1, us-east1, europe-west1, etc.)

GOOGLE_APPLICATION_CREDENTIALS=./secrets/gcp-service-account.json
# Local Development: Path to service account JSON file
# GCP Cloud Run: Not needed - uses default service account automatically

# Cloud Storage Buckets (created by gcp-setup.sh)
# Naming pattern: {GCP_PROJECT_ID}-{bucket-type}-{env}
GCS_BUCKET_VOICE_MODELS=digitwinlive-voice-models-dev
# Bucket for voice model files (.pth, .json)
GCS_BUCKET_FACE_MODELS=digitwinlive-face-models-dev
# Bucket for face model files (.pkl, images)
GCS_BUCKET_DOCUMENTS=digitwinlive-documents-dev
# Bucket for knowledge base documents (.pdf, .txt, .docx)
GCS_BUCKET_UPLOADS=digitwinlive-uploads-dev
# Bucket for temporary uploads (audio, video)

# Cloud SQL Connection Name (for Cloud Run)
CLOUD_SQL_CONNECTION_NAME=digitwinlive:us-central1:digitwinlive-db
# Format: PROJECT_ID:REGION:INSTANCE_NAME
# Used by Cloud Run's --add-cloudsql-instances flag for Unix socket connection

# Artifact Registry (for Docker images)
ARTIFACT_REGISTRY=us-central1-docker.pkg.dev/digitwinlive/digitwinlive
# Format: REGION-docker.pkg.dev/PROJECT_ID/REPOSITORY_NAME
# Created by gcp-setup.sh, used by gcp-deploy.sh for container images

# -----------------------------------------------------------------------------
# AI SERVICES - GOOGLE CHIRP (ASR)
# -----------------------------------------------------------------------------
GOOGLE_CHIRP_API_KEY=your-chirp-api-key
GOOGLE_CHIRP_LANGUAGE_CODE=en-US

# -----------------------------------------------------------------------------
# AI SERVICES - GEMINI (LLM)
# -----------------------------------------------------------------------------
GEMINI_API_KEY=your-gemini-api-key
GEMINI_MODEL=gemini-2.5-flash
# Options: gemini-2.5-flash, gemini-2.5-pro

# -----------------------------------------------------------------------------
# AI SERVICES - OPENAI
# -----------------------------------------------------------------------------
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_TTS_MODEL=tts-1
OPENAI_TTS_VOICE=alloy

# -----------------------------------------------------------------------------
# AI SERVICES - GROQ (Alternative LLM)
# -----------------------------------------------------------------------------
GROQ_API_KEY=your-groq-api-key
GROQ_MODEL=mixtral-8x7b-32768

# -----------------------------------------------------------------------------
# TTS SERVICES - GOOGLE CLOUD TTS
# -----------------------------------------------------------------------------
GOOGLE_TTS_API_KEY=your-google-tts-api-key
GOOGLE_TTS_VOICE_NAME=en-US-Neural2-A
GOOGLE_TTS_LANGUAGE_CODE=en-US

# -----------------------------------------------------------------------------
# TTS SERVICES - XTTS-V2 (Self-hosted)
# -----------------------------------------------------------------------------
XTTS_SERVICE_URL=http://127.0.0.1:8000
# GCP: Deploy as separate Cloud Run service if needed
XTTS_GPU_ENABLED=true

# -----------------------------------------------------------------------------
# LIP-SYNC SERVICE
# -----------------------------------------------------------------------------
LIPSYNC_SERVICE_URL=http://127.0.0.1:8001
# GCP: https://face-processing-service-yrzc7r3fcq-uc.a.run.app
LIPSYNC_MODEL=tpsm
LIPSYNC_GPU_ENABLED=true

# -----------------------------------------------------------------------------
# RATE LIMITING
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
# 15 minutes in milliseconds

RATE_LIMIT_MAX_REQUESTS=100
# Max requests per window

RATE_LIMIT_AUTH_MAX=5
# Max auth attempts per window

RATE_LIMIT_UPLOAD_MAX=10
# Max uploads per window

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
LOG_LEVEL=info
# Options: error, warn, info, debug

LOG_FORMAT=json
# Options: json, simple

LOG_FILE_PATH=./logs/app.log
LOG_ERROR_FILE_PATH=./logs/error.log
# GCP Cloud Run: Logs automatically sent to Cloud Logging (no file paths needed)


# -----------------------------------------------------------------------------
# MONITORING & OBSERVABILITY
# -----------------------------------------------------------------------------
# Sentry (Error Tracking)
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=development
# GCP: production

# New Relic (APM)
NEW_RELIC_LICENSE_KEY=your-new-relic-license-key
NEW_RELIC_APP_NAME=digitwinlive

# Datadog
DATADOG_API_KEY=your-datadog-api-key
DATADOG_APP_KEY=your-datadog-app-key

# -----------------------------------------------------------------------------
# EMAIL SERVICE (for notifications, password reset, etc.)
# -----------------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=noreply@digitwinlive.com
SMTP_FROM_NAME=DigiTwin Live

# Alternative: SendGrid
SENDGRID_API_KEY=your-sendgrid-api-key

# Alternative: AWS SES
AWS_SES_REGION=us-east-1
AWS_SES_ACCESS_KEY_ID=your-aws-access-key
AWS_SES_SECRET_ACCESS_KEY=your-aws-secret-key

# -----------------------------------------------------------------------------
# PAYMENT PROCESSING (for subscriptions)
# -----------------------------------------------------------------------------
# Stripe
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# Subscription Price IDs
STRIPE_PRICE_ID_PRO=price_pro_monthly
STRIPE_PRICE_ID_ENTERPRISE=price_enterprise_monthly

# -----------------------------------------------------------------------------
# CONTENT SAFETY
# -----------------------------------------------------------------------------
# Perspective API (Toxicity Detection)
PERSPECTIVE_API_KEY=your-perspective-api-key

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------
FEATURE_OAUTH_GOOGLE=true
FEATURE_OAUTH_APPLE=true
FEATURE_VOICE_CLONING=true
FEATURE_FACE_CLONING=true
FEATURE_VIDEO_GENERATION=true
FEATURE_ANALYTICS=true

# -----------------------------------------------------------------------------
# SUBSCRIPTION LIMITS
# -----------------------------------------------------------------------------
# Free Tier
FREE_TIER_CONVERSATION_MINUTES_PER_DAY=60
FREE_TIER_DOCUMENTS_PER_MONTH=10
FREE_TIER_VOICE_MODELS=1

# Pro Tier
PRO_TIER_CONVERSATION_MINUTES_PER_DAY=0
# 0 = unlimited
PRO_TIER_DOCUMENTS_PER_MONTH=100
PRO_TIER_VOICE_MODELS=5

# Enterprise Tier
ENTERPRISE_TIER_CONVERSATION_MINUTES_PER_DAY=0
ENTERPRISE_TIER_DOCUMENTS_PER_MONTH=0
ENTERPRISE_TIER_VOICE_MODELS=0

# -----------------------------------------------------------------------------
# SECURITY
# -----------------------------------------------------------------------------
# Password Requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=false

# Session Security
SESSION_SECRET=your-session-secret-change-this
SESSION_TIMEOUT_MINUTES=60

# CSRF Protection
CSRF_SECRET=your-csrf-secret-change-this

# -----------------------------------------------------------------------------
# DEVELOPMENT TOOLS
# -----------------------------------------------------------------------------
# Enable API documentation in production
ENABLE_API_DOCS=true
# Local: true
# GCP Production: false

# Enable debug endpoints
ENABLE_DEBUG_ENDPOINTS=true
# Local: true
# GCP Production: false

# Mock external services (for testing)
MOCK_EXTERNAL_SERVICES=false

# -----------------------------------------------------------------------------
# PERFORMANCE
# -----------------------------------------------------------------------------
# Enable compression
ENABLE_COMPRESSION=true

# -----------------------------------------------------------------------------
# MOBILE APP CONFIGURATION
# -----------------------------------------------------------------------------
MOBILE_APP_VERSION=1.0.0
MOBILE_APP_BUILD_NUMBER=1
MOBILE_FORCE_UPDATE_VERSION=1.0.0

# Deep Linking
DEEP_LINK_SCHEME=digitwinlive
DEEP_LINK_HOST=app.digitwinlive.com

# -----------------------------------------------------------------------------
# ANALYTICS
# -----------------------------------------------------------------------------
# Google Analytics
GA_TRACKING_ID=UA-XXXXXXXXX-X

# Mixpanel
MIXPANEL_TOKEN=your-mixpanel-token

# Amplitude
AMPLITUDE_API_KEY=your-amplitude-api-key

# -----------------------------------------------------------------------------
# WEBHOOKS
# -----------------------------------------------------------------------------
WEBHOOK_SECRET=your-webhook-secret
WEBHOOK_TIMEOUT_MS=5000

# -----------------------------------------------------------------------------
# BACKUP & DISASTER RECOVERY
# -----------------------------------------------------------------------------
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
# Daily at 2 AM (cron format)
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_BUCKET=digitwinlive-backups-dev

# -----------------------------------------------------------------------------
# COMPLIANCE
# -----------------------------------------------------------------------------
# Data Retention
DATA_RETENTION_DAYS=90
AUDIT_LOG_RETENTION_DAYS=365

# GDPR
GDPR_ENABLED=true
GDPR_DATA_EXPORT_ENABLED=true
GDPR_RIGHT_TO_DELETION_ENABLED=true

# -----------------------------------------------------------------------------
# TESTING
# -----------------------------------------------------------------------------
TEST_DATABASE_URL=postgresql://postgres:test@127.0.0.1:5432/digitwinlive_test
TEST_USER_EMAIL=test@example.com
TEST_USER_PASSWORD=testpassword123

# =============================================================================
# DEPLOYMENT QUICK REFERENCE
# =============================================================================
#
# LOCAL DEVELOPMENT:
#   API Gateway:        http://127.0.0.1:3000
#   WebSocket Server:   http://127.0.0.1:3001
#   Face Processing:    http://127.0.0.1:8001
#   Database:           127.0.0.1:5432 (local PostgreSQL)
#
# GCP CLOUD RUN (Production):
#   API Gateway:        https://api-gateway-yrzc7r3fcq-uc.a.run.app
#   WebSocket Server:   wss://websocket-server-yrzc7r3fcq-uc.a.run.app
#   Face Processing:    https://face-processing-service-yrzc7r3fcq-uc.a.run.app
#   Database:           Cloud SQL via Unix socket (/cloudsql/PROJECT:REGION:INSTANCE)
#   Secrets:            GCP Secret Manager (jwt-secret, refresh-secret, database-password)
#
# SETUP COMMANDS:
#   1. Setup GCP infrastructure:
#      Development: ./scripts/gcp-setup.sh --env=development
#      Production:  ./scripts/gcp-setup.sh --env=production
#      Buckets only: ./scripts/gcp-setup.sh --env=production --buckets-only
#
#   2. Enable pgvector extension (connect to Cloud SQL):
#      CREATE EXTENSION IF NOT EXISTS vector;
#
#   3. Run database migrations:
#      pnpm db:migrate:deploy
#
# DEPLOYMENT COMMANDS:
#   Deploy all (development):
#      ./scripts/gcp-deploy.sh deploy --env=development
#
#   Deploy all (production):
#      ./scripts/gcp-deploy.sh deploy --env=production
#
#   Deploy specific service:
#      ./scripts/gcp-deploy.sh deploy api-gateway --env=production
#
#   Check deployment status:
#      ./scripts/gcp-deploy.sh status
#
#   Get service URLs:
#      ./scripts/gcp-deploy.sh urls
#
#   Delete service:
#      ./scripts/gcp-deploy.sh delete websocket-server
#
# MANAGEMENT COMMANDS:
#   Check infrastructure status:
#      ./scripts/gcp-manage.sh status
#
#   Start Cloud SQL:
#      ./scripts/gcp-manage.sh start
#
#   Stop Cloud SQL:
#      ./scripts/gcp-manage.sh stop
#
#   Estimate costs:
#      ./scripts/gcp-manage.sh cost
#
# ENVIRONMENT FILES:
#   .env.development    - Development configuration (localhost URLs)
#   .env.production     - Production configuration (Cloud Run URLs, secrets)
#   .env                - Active environment (copy from .env.development or .env.production)
#
# =============================================================================
